{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../utils/api\";\n\n/* =========================\n   ASYNC THUNKS\n========================= */\n\n// Register\nexport const register = createAsyncThunk(\"auth/register\", async (userData, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await api.post(\"/auth/register\", userData, {\n      withCredentials: true\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response;\n    return rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || {\n      error: \"Registration failed\"\n    });\n  }\n});\n\n// Login\nexport const login = createAsyncThunk(\"auth/login\", async (credentials, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await api.post(\"/auth/login\", credentials, {\n      withCredentials: true\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response2;\n    return rejectWithValue(((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || {\n      error: \"Login failed\"\n    });\n  }\n});\n\n// Get current user (COOKIE BASED)\nexport const getMe = createAsyncThunk(\"auth/getMe\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await api.get(\"/auth/me\", {\n      withCredentials: true\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response3;\n    return rejectWithValue(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : _error$response3.data) || {\n      error: \"Unauthorized\"\n    });\n  }\n});\n\n// Switch project\nexport const switchProject = createAsyncThunk(\"auth/switchProject\", async (projectId, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await api.put(`/auth/switch-project/${projectId}`, {}, {\n      withCredentials: true\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response4;\n    return rejectWithValue(((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : _error$response4.data) || {\n      error: \"Project switch failed\"\n    });\n  }\n});\n\n// Logout (SERVER + COOKIE)\nexport const logout = createAsyncThunk(\"auth/logout\", async () => {\n  await api.post(\"/auth/logout\", {}, {\n    withCredentials: true\n  });\n  return null;\n});\n\n/* =========================\n   SLICE\n========================= */\n\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    user: null,\n    loading: false,\n    error: null,\n    isAuthenticated: false\n  },\n  reducers: {\n    clearError: state => {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder\n\n    // Register\n    .addCase(register.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(register.fulfilled, (state, action) => {\n      state.loading = false;\n      state.user = action.payload.data;\n      state.isAuthenticated = true;\n    }).addCase(register.rejected, (state, action) => {\n      var _action$payload;\n      state.loading = false;\n      state.error = (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.error;\n    })\n\n    // Login\n    .addCase(login.pending, state => {\n      state.loading = true;\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.loading = false;\n      state.user = action.payload.data;\n      state.isAuthenticated = true;\n    }).addCase(login.rejected, (state, action) => {\n      var _action$payload2;\n      state.loading = false;\n      state.error = (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.error;\n    })\n\n    // Get Me\n    .addCase(getMe.pending, state => {\n      state.loading = true;\n    }).addCase(getMe.fulfilled, (state, action) => {\n      state.loading = false;\n      state.user = action.payload.data;\n      state.isAuthenticated = true;\n    }).addCase(getMe.rejected, state => {\n      state.loading = false;\n      state.user = null;\n      state.isAuthenticated = false;\n    })\n\n    // Switch Project\n    .addCase(switchProject.fulfilled, (state, action) => {\n      state.user = action.payload.data;\n    })\n\n    // Logout\n    .addCase(logout.fulfilled, state => {\n      state.user = null;\n      state.isAuthenticated = false;\n    });\n  }\n});\nexport const {\n  clearError\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","register","userData","rejectWithValue","response","post","withCredentials","data","error","_error$response","login","credentials","_error$response2","getMe","_","get","_error$response3","switchProject","projectId","put","_error$response4","logout","authSlice","name","initialState","user","loading","isAuthenticated","reducers","clearError","state","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","_action$payload","_action$payload2","actions","reducer"],"sources":["/home/pranjal/Pranjal/vscode/crm_portal/frontend/src/redux/slices/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../utils/api\";\n\n/* =========================\n   ASYNC THUNKS\n========================= */\n\n// Register\nexport const register = createAsyncThunk(\n  \"auth/register\",\n  async (userData, { rejectWithValue }) => {\n    try {\n      const response = await api.post(\"/auth/register\", userData, {\n        withCredentials: true,\n      });\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(\n        error.response?.data || { error: \"Registration failed\" }\n      );\n    }\n  }\n);\n\n// Login\nexport const login = createAsyncThunk(\n  \"auth/login\",\n  async (credentials, { rejectWithValue }) => {\n    try {\n      const response = await api.post(\"/auth/login\", credentials, {\n        withCredentials: true,\n      });\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(\n        error.response?.data || { error: \"Login failed\" }\n      );\n    }\n  }\n);\n\n// Get current user (COOKIE BASED)\nexport const getMe = createAsyncThunk(\n  \"auth/getMe\",\n  async (_, { rejectWithValue }) => {\n    try {\n      const response = await api.get(\"/auth/me\", {\n        withCredentials: true,\n      });\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(\n        error.response?.data || { error: \"Unauthorized\" }\n      );\n    }\n  }\n);\n\n// Switch project\nexport const switchProject = createAsyncThunk(\n  \"auth/switchProject\",\n  async (projectId, { rejectWithValue }) => {\n    try {\n      const response = await api.put(\n        `/auth/switch-project/${projectId}`,\n        {},\n        { withCredentials: true }\n      );\n      return response.data;\n    } catch (error) {\n      return rejectWithValue(\n        error.response?.data || { error: \"Project switch failed\" }\n      );\n    }\n  }\n);\n\n// Logout (SERVER + COOKIE)\nexport const logout = createAsyncThunk(\"auth/logout\", async () => {\n  await api.post(\"/auth/logout\", {}, { withCredentials: true });\n  return null;\n});\n\n/* =========================\n   SLICE\n========================= */\n\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState: {\n    user: null,\n    loading: false,\n    error: null,\n    isAuthenticated: false,\n  },\n  reducers: {\n    clearError: (state) => {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n\n      // Register\n      .addCase(register.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(register.fulfilled, (state, action) => {\n        state.loading = false;\n        state.user = action.payload.data;\n        state.isAuthenticated = true;\n      })\n      .addCase(register.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload?.error;\n      })\n\n      // Login\n      .addCase(login.pending, (state) => {\n        state.loading = true;\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.loading = false;\n        state.user = action.payload.data;\n        state.isAuthenticated = true;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload?.error;\n      })\n\n      // Get Me\n      .addCase(getMe.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(getMe.fulfilled, (state, action) => {\n        state.loading = false;\n        state.user = action.payload.data;\n        state.isAuthenticated = true;\n      })\n      .addCase(getMe.rejected, (state) => {\n        state.loading = false;\n        state.user = null;\n        state.isAuthenticated = false;\n      })\n\n      // Switch Project\n      .addCase(switchProject.fulfilled, (state, action) => {\n        state.user = action.payload.data;\n      })\n\n      // Logout\n      .addCase(logout.fulfilled, (state) => {\n        state.user = null;\n        state.isAuthenticated = false;\n      });\n  },\n});\n\nexport const { clearError } = authSlice.actions;\nexport default authSlice.reducer;\n"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,GAAG,MAAM,iBAAiB;;AAEjC;AACA;AACA;;AAEA;AACA,OAAO,MAAMC,QAAQ,GAAGF,gBAAgB,CACtC,eAAe,EACf,OAAOG,QAAQ,EAAE;EAAEC;AAAgB,CAAC,KAAK;EACvC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMJ,GAAG,CAACK,IAAI,CAAC,gBAAgB,EAAEH,QAAQ,EAAE;MAC1DI,eAAe,EAAE;IACnB,CAAC,CAAC;IACF,OAAOF,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAC,eAAA;IACd,OAAON,eAAe,CACpB,EAAAM,eAAA,GAAAD,KAAK,CAACJ,QAAQ,cAAAK,eAAA,uBAAdA,eAAA,CAAgBF,IAAI,KAAI;MAAEC,KAAK,EAAE;IAAsB,CACzD,CAAC;EACH;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAME,KAAK,GAAGX,gBAAgB,CACnC,YAAY,EACZ,OAAOY,WAAW,EAAE;EAAER;AAAgB,CAAC,KAAK;EAC1C,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMJ,GAAG,CAACK,IAAI,CAAC,aAAa,EAAEM,WAAW,EAAE;MAC1DL,eAAe,EAAE;IACnB,CAAC,CAAC;IACF,OAAOF,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAI,gBAAA;IACd,OAAOT,eAAe,CACpB,EAAAS,gBAAA,GAAAJ,KAAK,CAACJ,QAAQ,cAAAQ,gBAAA,uBAAdA,gBAAA,CAAgBL,IAAI,KAAI;MAAEC,KAAK,EAAE;IAAe,CAClD,CAAC;EACH;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMK,KAAK,GAAGd,gBAAgB,CACnC,YAAY,EACZ,OAAOe,CAAC,EAAE;EAAEX;AAAgB,CAAC,KAAK;EAChC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMJ,GAAG,CAACe,GAAG,CAAC,UAAU,EAAE;MACzCT,eAAe,EAAE;IACnB,CAAC,CAAC;IACF,OAAOF,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAQ,gBAAA;IACd,OAAOb,eAAe,CACpB,EAAAa,gBAAA,GAAAR,KAAK,CAACJ,QAAQ,cAAAY,gBAAA,uBAAdA,gBAAA,CAAgBT,IAAI,KAAI;MAAEC,KAAK,EAAE;IAAe,CAClD,CAAC;EACH;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMS,aAAa,GAAGlB,gBAAgB,CAC3C,oBAAoB,EACpB,OAAOmB,SAAS,EAAE;EAAEf;AAAgB,CAAC,KAAK;EACxC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMJ,GAAG,CAACmB,GAAG,CAC5B,wBAAwBD,SAAS,EAAE,EACnC,CAAC,CAAC,EACF;MAAEZ,eAAe,EAAE;IAAK,CAC1B,CAAC;IACD,OAAOF,QAAQ,CAACG,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAY,gBAAA;IACd,OAAOjB,eAAe,CACpB,EAAAiB,gBAAA,GAAAZ,KAAK,CAACJ,QAAQ,cAAAgB,gBAAA,uBAAdA,gBAAA,CAAgBb,IAAI,KAAI;MAAEC,KAAK,EAAE;IAAwB,CAC3D,CAAC;EACH;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMa,MAAM,GAAGtB,gBAAgB,CAAC,aAAa,EAAE,YAAY;EAChE,MAAMC,GAAG,CAACK,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,EAAE;IAAEC,eAAe,EAAE;EAAK,CAAC,CAAC;EAC7D,OAAO,IAAI;AACb,CAAC,CAAC;;AAEF;AACA;AACA;;AAEA,MAAMgB,SAAS,GAAGxB,WAAW,CAAC;EAC5ByB,IAAI,EAAE,MAAM;EACZC,YAAY,EAAE;IACZC,IAAI,EAAE,IAAI;IACVC,OAAO,EAAE,KAAK;IACdlB,KAAK,EAAE,IAAI;IACXmB,eAAe,EAAE;EACnB,CAAC;EACDC,QAAQ,EAAE;IACRC,UAAU,EAAGC,KAAK,IAAK;MACrBA,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB;EACF,CAAC;EACDuB,aAAa,EAAGC,OAAO,IAAK;IAC1BA;;IAEE;IAAA,CACCC,OAAO,CAAChC,QAAQ,CAACiC,OAAO,EAAGJ,KAAK,IAAK;MACpCA,KAAK,CAACJ,OAAO,GAAG,IAAI;MACpBI,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDyB,OAAO,CAAChC,QAAQ,CAACkC,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC9CN,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACL,IAAI,GAAGW,MAAM,CAACC,OAAO,CAAC9B,IAAI;MAChCuB,KAAK,CAACH,eAAe,GAAG,IAAI;IAC9B,CAAC,CAAC,CACDM,OAAO,CAAChC,QAAQ,CAACqC,QAAQ,EAAE,CAACR,KAAK,EAAEM,MAAM,KAAK;MAAA,IAAAG,eAAA;MAC7CT,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACtB,KAAK,IAAA+B,eAAA,GAAGH,MAAM,CAACC,OAAO,cAAAE,eAAA,uBAAdA,eAAA,CAAgB/B,KAAK;IACrC,CAAC;;IAED;IAAA,CACCyB,OAAO,CAACvB,KAAK,CAACwB,OAAO,EAAGJ,KAAK,IAAK;MACjCA,KAAK,CAACJ,OAAO,GAAG,IAAI;MACpBI,KAAK,CAACtB,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDyB,OAAO,CAACvB,KAAK,CAACyB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC3CN,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACL,IAAI,GAAGW,MAAM,CAACC,OAAO,CAAC9B,IAAI;MAChCuB,KAAK,CAACH,eAAe,GAAG,IAAI;IAC9B,CAAC,CAAC,CACDM,OAAO,CAACvB,KAAK,CAAC4B,QAAQ,EAAE,CAACR,KAAK,EAAEM,MAAM,KAAK;MAAA,IAAAI,gBAAA;MAC1CV,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACtB,KAAK,IAAAgC,gBAAA,GAAGJ,MAAM,CAACC,OAAO,cAAAG,gBAAA,uBAAdA,gBAAA,CAAgBhC,KAAK;IACrC,CAAC;;IAED;IAAA,CACCyB,OAAO,CAACpB,KAAK,CAACqB,OAAO,EAAGJ,KAAK,IAAK;MACjCA,KAAK,CAACJ,OAAO,GAAG,IAAI;IACtB,CAAC,CAAC,CACDO,OAAO,CAACpB,KAAK,CAACsB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC3CN,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACL,IAAI,GAAGW,MAAM,CAACC,OAAO,CAAC9B,IAAI;MAChCuB,KAAK,CAACH,eAAe,GAAG,IAAI;IAC9B,CAAC,CAAC,CACDM,OAAO,CAACpB,KAAK,CAACyB,QAAQ,EAAGR,KAAK,IAAK;MAClCA,KAAK,CAACJ,OAAO,GAAG,KAAK;MACrBI,KAAK,CAACL,IAAI,GAAG,IAAI;MACjBK,KAAK,CAACH,eAAe,GAAG,KAAK;IAC/B,CAAC;;IAED;IAAA,CACCM,OAAO,CAAChB,aAAa,CAACkB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MACnDN,KAAK,CAACL,IAAI,GAAGW,MAAM,CAACC,OAAO,CAAC9B,IAAI;IAClC,CAAC;;IAED;IAAA,CACC0B,OAAO,CAACZ,MAAM,CAACc,SAAS,EAAGL,KAAK,IAAK;MACpCA,KAAK,CAACL,IAAI,GAAG,IAAI;MACjBK,KAAK,CAACH,eAAe,GAAG,KAAK;IAC/B,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEE;AAAW,CAAC,GAAGP,SAAS,CAACmB,OAAO;AAC/C,eAAenB,SAAS,CAACoB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}